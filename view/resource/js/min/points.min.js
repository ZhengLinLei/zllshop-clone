window.addEventListener("load",()=>{let button_change=document.querySelector("button#button_change_money"),button_get=document.querySelector("#get_points button");button_get&&button_get.addEventListener("click",()=>{let body=`code=${code}`;button_get.disabled=!0,fetch("./api/points?type=get",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:body}).then(response=>response.json()).then(data=>{if(200==data.response){let points=parseInt($("#daily_points_num").html()),timer=setInterval(()=>{points==data.data.points?clearInterval(timer):(points+=1,$("#daily_points_num").html(points))},25);$("#add_points").addClass("d-inline"),$("#get_points").html('<div class="text-success font-weight-bold"><i class="fas fa-calendar-check"></i> 今天已签到</div>')}else button_get.disabled=!1,$("#info_get").addClass("text-danger"),$("#info_get").removeClass("adv"),$("#info_get").html("签到失败")})}),button_change.addEventListener("click",()=>{let body=`code=${code}`;button_change.disabled=!0,fetch("./api/points?type=change",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:body}).then(response=>response.json()).then(data=>{if(200==data.response){$("#change_money").html(`${data.data.rmb}￥ - ${data.data.euro}€`);let points=data.data.points;$("#change_points").html(`-${points}分`),$("#Modal").modal("show");let timer=setInterval(()=>{0==points?clearInterval(timer):(points-=points<100?1:points<500&&points>=100?10:points<1500&&points>=500?50:100,$("#daily_points_num").html(points))},5)}else button_change.disabled=!1})})});