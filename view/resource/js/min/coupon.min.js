window.addEventListener("load",()=>{const alert_dom=document.getElementById("alert");function alertEl(active,text){active?(alert_dom.querySelector("div > span#text").innerHTML=text,alert_dom.classList.remove("d-none")):alert_dom.classList.add("d-none")}let button_add_code=document.querySelector("button#button_add_code"),input_code=document.querySelector("input#coupon-input");button_add_code.addEventListener("click",()=>{if(input_code.value){let body=`coupon_code=${input_code.value}&code=${code}`;fetch("./api/coupon",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:body}).then(response=>response.json()).then(data=>{if(200==data.response){let yuan=document.getElementById("yuan"),euro=document.getElementById("euro");yuan.innerHTML=parseFloat(data.data.yuan),euro.innerHTML=parseFloat(data.data.euro),input_code.value=""}else"empty"==data.response?alertEl(!0,"你使用的折扣码无效"):"used"==data.response&&alertEl(!0,"此折扣码已被人使用")})}})});